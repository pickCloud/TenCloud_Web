webpackJsonp([2],{137:function(t,s,a){var e=a(7)(a(160),a(150),null,null);t.exports=e.exports},145:function(t,s,a){t.exports=a.p+"static/img/spin.b3959a2.gif"},150:function(t,s,a){t.exports={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"machine-add page-pad"},[e("panel",{attrs:{title:"添加主机"}},[e("m-row",{staticClass:"panel-form-list panel-body",attrs:{gutter:8}},[e("m-col",{staticClass:"xs-12 sm-3"},[e("div",{staticClass:"__content text-center"},[t._v("主机名称")])]),t._v(" "),e("m-col",{staticClass:"xs-12 sm-9"},[e("div",{staticClass:"__content"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.formdata.name,expression:"formdata.name"}],attrs:{type:"text"},domProps:{value:t.formdata.name},on:{input:function(s){s.target.composing||(t.formdata.name=s.target.value)}}})])]),t._v(" "),e("m-col",{staticClass:"xs-12 sm-3"},[e("div",{staticClass:"__content text-center"},[t._v("IP")])]),t._v(" "),e("m-col",{staticClass:"xs-12 sm-9"},[e("div",{staticClass:"__content"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.formdata.public_ip,expression:"formdata.public_ip"}],attrs:{type:"text"},domProps:{value:t.formdata.public_ip},on:{input:function(s){s.target.composing||(t.formdata.public_ip=s.target.value)}}})])]),t._v(" "),e("m-col",{staticClass:"xs-12 sm-3"},[e("div",{staticClass:"__content text-center"},[t._v("用户名")])]),t._v(" "),e("m-col",{staticClass:"xs-12 sm-9"},[e("div",{staticClass:"__content"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.formdata.username,expression:"formdata.username"}],attrs:{type:"text"},domProps:{value:t.formdata.username},on:{input:function(s){s.target.composing||(t.formdata.username=s.target.value)}}})])]),t._v(" "),e("m-col",{staticClass:"xs-12 sm-3"},[e("div",{staticClass:"__content text-center"},[t._v("密码")])]),t._v(" "),e("m-col",{staticClass:"xs-12 sm-9"},[e("div",{staticClass:"__content"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.formdata.passwd,expression:"formdata.passwd"}],attrs:{type:"password"},domProps:{value:t.formdata.passwd},on:{input:function(s){s.target.composing||(t.formdata.passwd=s.target.value)}}})])]),t._v(" "),"waiting"===t.status?e("m-col",{staticClass:"xs-12"},[e("img",{staticClass:"vam",attrs:{src:a(145),alt:""}}),t._v(" "),e("span",{staticClass:"vam"},[t._v("等待连接 大约需要1分钟")])]):t._e(),t._v(" "),"error"===t.status?e("m-col",{staticClass:"xs-12"},[e("div",{staticClass:"hongse-text"},[t._v("异常，请联系客服")])]):t._e(),t._v(" "),"save"===t.status?e("m-col",{staticClass:"xs-12 text-center"},[e("m-btn",{staticClass:"primary_bg no-radius grey-dark_txt",nativeOn:{click:function(s){t.addHost(s)}}},[t._v("确定添加")])],1):t._e()],1)],1)],1)},staticRenderFns:[]}},151:function(t,s,a){var e=a(3),i=e.JSON||(e.JSON={stringify:JSON.stringify});t.exports=function(t){return i.stringify.apply(i,arguments)}},152:function(t,s,a){t.exports={default:a(151),__esModule:!0}},155:function(t,s,a){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var e=a(152),i=function(t){return t&&t.__esModule?t:{default:t}}(e);s.default={data:function(){return{sokect:null,tcmname:"",formdata:{name:"",public_ip:"",username:"",passwd:"",cluster_id:0},status:"save",clusters:[]}},methods:{addHost:function(){var t=this;this.socket?this.sendHostData():this.initSocket(function(s){console.log(t.socket),t.sendHostData()})},sendHostData:function(){return""===this.formdata.name?void this.$toast("机器名称不能为空","cc"):""===this.formdata.public_ip?void this.$toast("public_ip不能为空","cc"):(this.socket.send((0,i.default)(this.formdata)),void(this.status="waiting"))},selectCluster:function(t){this.formdata.cluster_id=t},initClusters:function(){var t=this;this.rid=this.formdata.cluster_id=this.$route.params.id,0===parseInt(this.rid)?this.$Global.async("clusters").getData().then(function(s){t.clusters=s.data,t.formdata.cluster_id=t.clusters[0].id}):this.initSocket()},initSocket:function(){var t=this,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.socket=new WebSocket(this.$Global.apis.wsURL+this.$Global.apis.server_add.u),this.socket.onopen=function(t){s&&s()},this.socket.onmessage=function(s){"success"===s.data?t.$router.push({name:"ClusterDetail",params:{id:t.formdata.cluster_id}}):"open"!==s.data&&(t.status="save",t.$toast(s.data,"cc"))},this.socket.onclose=function(s){t.timeoutajax&&clearTimeout(t.timeoutajax),t.socket=null,console.log("socket has closed")},this.timeoutajax&&clearTimeout(this.timeoutajax),this.timeoutajax=setTimeout(function(s){t.status="error",t.$toast("异常，请联系客服","cc"),t.socket.close(),clearTimeout(t.timeoutajax)},6e5)}},created:function(){this.initClusters()},beforeDestroy:function(){this.socket&&this.socket.close()}}},160:function(t,s,a){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var e=a(155),i=function(t){return t&&t.__esModule?t:{default:t}}(e);s.default={mixins:[i.default]}}});
//# sourceMappingURL=2.08af0893de74ff1b052b.js.map