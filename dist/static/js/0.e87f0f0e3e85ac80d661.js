webpackJsonp([0],{138:function(t,s,a){var e=a(7)(a(161),a(146),null,null);t.exports=e.exports},143:function(t,s,a){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var e=a(52),i=function(t){return t&&t.__esModule?t:{default:t}}(e),n={theme:"comb-msg",hasClose:!1,buttons:[{label:"确定",theme:""},{label:"取消",theme:""}]};s.default={methods:{popperDelete:function(t,s){var a=this.$createElement;this.$confirm((0,i.default)({},n,{content:a("div",[a("img",{attrs:{src:"./static/img/error_icon.png",class:"vam m-r16"}}),a("span",{attrs:{class:"vam"}},"您确定删除主机"+t+"吗？")])}),function(t){0===(arguments.length<=1?void 0:arguments[1])&&s&&s.call(),t.actionPopper(!1)})},popperInfo:function(t,s,a){this.$confirm((0,i.default)({},n,{content:t}),function(t){0===(arguments.length<=1?void 0:arguments[1])?s&&s.call():a&&a.call(),t.actionPopper(!1)})}}}},144:function(t,s,a){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.default={business:{0:["运行中","primary_bg alpha-black_txt"],1:["已停止","pink_bg alpha-black_txt"],2:["启动中","primary_bg alpha-black_txt"],3:["停止中","pink_bg alpha-black_txt"],4:["满负载","pink_bg alpha-black_txt"]},machine:{Pending:["准备中","primary_bg alpha-black_txt","run"],Stopped:["已停止","pink_bg alpha-black_txt","stop"],Starting:["启动中","primary_bg alpha-black_txt","run"],Running:["运行中","primary_bg alpha-black_txt","run"],Stopping:["停止中","pink_bg alpha-black_txt","stop"],Deleted:["已释放","pink_bg alpha-black_txt","stop"]},server:{server_start:[3,"Starting","Running","机器启动中，这个过程需要大约","开机"],server_stop:[20,"Stopping","Stopped","机器关机中，这个过程需要大约","关机"],server_reboot:[30,"Stopping","Running","机器重启中，这个过程需要大约","重启机器"]}}},146:function(t,s){t.exports={render:function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"page-pad page-machine-detail"},[a("m-row",{attrs:{gutter:16}},[a("m-col",{staticClass:"xs-12 lg-8"},[a("panel",{staticClass:"m-b16"},[a("div",{staticClass:"panel-title",slot:"title"},[a("span",{staticClass:"bold m-r8"},[t._v("监控")])]),t._v(" "),a("m-row",{staticClass:"mdc-chart",attrs:{gutter:16}},[a("m-col",{staticClass:"xs-12 lg-6"},[a("panel",{staticClass:"p-b16",attrs:{title:"CPU"}},[a("e-line",{attrs:{data:t.cpu,label:"CPU使用量"}})],1)],1),t._v(" "),a("m-col",{staticClass:"xs-12 lg-6"},[a("panel",{staticClass:"p-b16",attrs:{title:"内存"}},[a("e-line",{attrs:{data:t.memory,label:"内存使用量","border-color":"#eb6565",linearg:["rgba(235,101,101,1)","rgba(235,101,101,0)"]}})],1)],1),t._v(" "),a("m-col",{staticClass:"xs-12 lg-6"},[a("panel",{staticClass:"p-b16"},[a("div",{staticClass:"panel-title m-b16",slot:"title"},[t._v("硬盘使用情况")]),t._v(" "),a("e-pie",{attrs:{data:t.disk,label:[{name:"使用",icon:"circle"},{name:"空余",icon:"circle"}],radius:["60%","50%"]}})],1)],1),t._v(" "),a("m-col",{staticClass:"xs-12 lg-6"},[a("panel",{staticClass:"p-b16",attrs:{title:"网络"}})],1)],1)],1)],1),t._v(" "),a("m-col",{staticClass:"xs-12 lg-4"},[a("panel",{staticClass:"m-b16"},[a("div",{staticClass:"panel-title clearfix",slot:"title"},[a("span",{staticClass:"bold"},[t._v("基本信息")]),t._v(" "),a("span",{staticClass:"right"},[t.isInfoEditor?t._e():a("span",{on:{click:t.editorBegin}},[a("span",{staticClass:"inline-block m-r8"},[t._v("修改")]),t._v(" "),a("i",{staticClass:"icon-quan"})]),t._v(" "),t.isInfoEditor?a("span",{on:{click:t.editorSure}},[a("span",{staticClass:"inline-block m-r8"},[t._v("确定")]),t._v(" "),a("i",{staticClass:"icon-quan"})]):t._e(),t._v(" "),t.isInfoEditor?a("span",{on:{click:t.editorCancel}},[a("span",{staticClass:"inline-block m-r8"},[t._v("取消")]),t._v(" "),a("i",{staticClass:"icon-quan"})]):t._e()])]),t._v(" "),a("div",{staticClass:"panel-list mcd-ctrl-group"},[a("div",{staticClass:"mcd-ctrl-item"},[t.isWaiting?t._e():a("span",[t._v("开机 "),a("m-switch",{staticClass:"switchMachine",attrs:{disabled:t.isDisabled},on:{change:t.machineChange},model:{value:t.isOpen,callback:function(s){t.isOpen=s},expression:"isOpen"}})],1)]),t._v(" "),a("div",{staticClass:"mcd-ctrl-item"},["run"!==t.machineStatus[2]||t.isWaiting?t._e():a("m-btn",{nativeOn:{click:function(s){t.machineCtrPop("server_reboot")}}},[t._v("重启 "),a("i",{staticClass:"icon-quan"})])],1),t._v(" "),a("div",{staticClass:"mcd-ctrl-item"},[a("m-btn",{nativeOn:{click:function(s){t.deleteMachine(s)}}},[t._v("删除 "),a("i",{staticClass:"icon-quan"})])],1),t._v(" "),a("span",{staticClass:"justify_fix"})]),t._v(" "),t.isWaiting?a("m-row",{staticClass:"panel-list"},[a("m-col",{staticClass:"xs-12"},[t._v(t._s(t.waitingTip))])],1):t._e(),t._v(" "),a("m-row",{staticClass:"panel-list"},[a("m-col",{staticClass:"xs-4"},[t._v("名称")]),t._v(" "),a("m-col",{staticClass:"xs-8"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.baseInfo.name,expression:"baseInfo.name"}],staticClass:"edirot-input",attrs:{type:"text","data-key":"baseInfo.name","data-name":"name",readonly:""},domProps:{value:t.baseInfo.name},on:{input:function(s){s.target.composing||(t.baseInfo.name=s.target.value)}}})])],1),t._v(" "),a("m-row",{staticClass:"panel-list"},[a("m-col",{staticClass:"xs-4"},[t._v("服务商")]),t._v(" "),a("m-col",{staticClass:"xs-8"},[t._v(t._s(t.baseInfo.cluster_name))])],1),t._v(" "),a("m-row",{staticClass:"panel-list"},[a("m-col",{staticClass:"xs-4"},[t._v("地址")]),t._v(" "),a("m-col",{staticClass:"xs-8"},[t._v(t._s(t.baseInfo.address))])],1),t._v(" "),a("m-row",{staticClass:"panel-list"},[a("m-col",{staticClass:"xs-4"},[t._v("IP")]),t._v(" "),a("m-col",{staticClass:"xs-8"},[t._v(t._s(t.baseInfo.public_ip))])],1),t._v(" "),a("m-row",{staticClass:"panel-list"},[a("m-col",{staticClass:"xs-4"},[t._v("状态")]),t._v(" "),a("m-col",{staticClass:"xs-8"},[a("span",{staticClass:"plate",class:t.machineStatus[1]},[t._v(t._s(t.machineStatus[0]))])])],1)],1),t._v(" "),a("panel",{staticClass:"m-b16"},[a("div",{staticClass:"panel-title clearfix",slot:"title"},[a("span",{staticClass:"bold"},[t._v("配置信息")])]),t._v(" "),a("m-row",{staticClass:"panel-list"},[a("m-col",{staticClass:"xs-4"},[t._v("操作系统")]),t._v(" "),a("m-col",{staticClass:"xs-8"},[t._v(t._s(t.sysInfo.config.os_name))])],1),t._v(" "),a("m-row",{staticClass:"panel-list"},[a("m-col",{staticClass:"xs-4"},[t._v("系统类型")]),t._v(" "),a("m-col",{staticClass:"xs-8"},[t._v(t._s(t.sysInfo.config.os_type))])],1),t._v(" "),a("m-row",{staticClass:"panel-list"},[a("m-col",{staticClass:"xs-4"},[t._v("CPU")]),t._v(" "),a("m-col",{staticClass:"xs-8"},[t._v(t._s(t.sysInfo.config.cpu))])],1),t._v(" "),a("m-row",{staticClass:"panel-list"},[a("m-col",{staticClass:"xs-4"},[t._v("内存")]),t._v(" "),a("m-col",{staticClass:"xs-8"},[t._v(t._s(parseInt(t.sysInfo.config.memory)/1024)+"G")])],1),t._v(" "),a("m-row",{staticClass:"panel-list"},[a("m-col",{staticClass:"xs-4"}),t._v(" "),a("m-col",{staticClass:"xs-8"})],1)],1)],1),t._v(" "),a("m-col",{staticClass:"xs-12"},[a("panel",{staticClass:"p-b16 m-b16",attrs:{title:"应用"}},[a("div",{staticClass:"panel-body"},[a("m-table",{staticClass:"hover striped block-table centered"},[a("col",{attrs:{width:"15%"}}),t._v(" "),a("col",{attrs:{width:"20%"}}),t._v(" "),a("col",{attrs:{width:"20%"}}),t._v(" "),a("col",{attrs:{width:"25%"}}),t._v(" "),a("col",{attrs:{width:"15%"}}),t._v(" "),a("thead",[a("tr",[a("th",[t._v("containerID")]),t._v(" "),a("th",[t._v("名称")]),t._v(" "),a("th",[t._v("状态")]),t._v(" "),a("th",[t._v("更新时间")]),t._v(" "),a("th",[t._v("操作")])])]),t._v(" "),a("tbody",t._l(t.applists,function(s){return a("tr",[a("td",[t._v(t._s(s[0]))]),t._v(" "),a("td",[t._v(t._s(s[1]))]),t._v(" "),a("td",[t._v(t._s(s[2]))]),t._v(" "),a("td",[t._v(t._s(s[3]))]),t._v(" "),a("td",[a("m-btn",{staticClass:"primary_txt"},[t._v("详情")])],1)])}))])],1)])],1)],1)],1)},staticRenderFns:[]}},153:function(t,s,a){"use strict";Object.defineProperty(s,"__esModule",{value:!0});s.default={data:function(){return{cpu:[],memory:[],disk:[],performance:"server_performance"}},methods:{formatDate:function(t){return[new Date(1e3*t[0]).Format("yyyy/MM/dd hh:mm:ss"),t[1].percent]},formatDisk:function(t){var s=t[0][1].free,a=t[0][1].total;return[{value:this.toG(a-s),name:"使用",itemStyle:{normal:{color:"#48bbc0"}}},{value:this.toG(s),name:"空余",itemStyle:{normal:{color:"#ffe0b2"}}}]},toG:function(t){return(t/1024/1024/1024).toFixed(2)},getPerformance:function(){var t=this,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=new Date,e=new Date(a.getTime()-6e4*s);this.$Global.async(this.performance,!0).getData({id:this.machineid,start_time:Date.parse(e)/1e3,end_time:Date.parse(a)/1e3}).then(function(s){if(0===s.status){var a=s.data;a.cpu.length>20&&(a.cpu=a.cpu.slice(-20));for(var e in a.cpu)a.cpu[e]=t.formatDate(a.cpu[e]);t.chartData("cpu",a.cpu),a.memory.length>20&&(a.memory=a.memory.slice(-20));for(var i in a.memory)a.memory[i]=t.formatDate(a.memory[i]);t.chartData("memory",a.memory),a.disk.length>0&&(t.disk=t.formatDisk(a.disk.slice(-1))),t.temptimeout=setTimeout(function(s){t.getPerformance(1),clearTimeout(t.temptimeout)},6e4)}})},chartData:function(t,s){var a=this,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;0===this[t].length?this[t]=s.slice(s.length-e):s.forEach(function(s,i){a[t].length>=e&&a[t].shift(),a[t].push(s)})}},mounted:function(){this.getPerformance(2400)},beforeDestroy:function(){this.temptimeout&&clearTimeout(this.temptimeout)}}},154:function(t,s,a){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.default={data:function(){return{isInfoEditor:!1,infoEditorTemp:{}}},methods:{getValueByKey:function(t){return t.split(".").reduce(function(t,s){return t[s]},this)},editorBegin:function(){var t=this;this.isInfoEditor=!0,this.editorElements||(this.editorElements=this.$el.querySelectorAll(".edirot-input")),this.editorElements.forEach(function(s,a){s.removeAttribute("readonly"),t.infoEditorTemp[s.dataset.key]=s.value})},editorSure:function(){var t=this,s={},a=!1;this.isInfoEditor=!1,this.editorElements.forEach(function(e,i){e.setAttribute("readonly","readonly");var n=t.getValueByKey(e.dataset.key);n!==t.infoEditorTemp[e.dataset.key]&&(s[e.dataset.name]=n,a=!0)}),a&&(s.id=this.$route.params.id,this.$Global.async(this.updateApi,!0).getData(s).then(function(s){t.$toast(s.message,"cc")}))},setValueBuKey:function(t,s){var a=this,e=t.split(".");e.forEach(function(t,i){i===e.length-1?a[t]=s:a=a[t]})},editorCancel:function(){var t=this;this.isInfoEditor=!1,this.editorElements.forEach(function(s,a){s.setAttribute("readonly","readonly"),t.setValueBuKey(s.dataset.key,t.infoEditorTemp[s.dataset.key])})}}}},156:function(t,s,a){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(s,"__esModule",{value:!0});var i=a(144),n=e(i),l=a(154),c=e(l),o=a(153),r=e(o),u=a(143),m=e(u);s.default={mixins:[r.default,c.default,m.default],data:function(){return{baseInfo:{cluster_id:-1,cluster_name:""},businessInfo:{contract:{},provider:""},sysInfo:{config:{}},applists:[],machineid:-1,isWaiting:!1,waitingTip:"",isOpen:!1,isDisabled:!1,updateApi:"server_update"}},methods:{getApiData:function(){var t=this;this.machineid=this.$route.params.id,this.$Global.async("server_detail",!0).getData(null,this.machineid).then(function(s){0===s.status&&(t.baseInfo=s.data.basic_info,t.businessInfo=s.data.business_info,t.sysInfo=s.data.system_info,"run"===t.machineStatus[2]&&(t.isOpen=!0),"stop"===t.machineStatus[2]&&(t.isOpen=!1))}),this.$Global.async("server_applist",!0).getData(null,this.machineid).then(function(s){0===s.status&&(t.applists=s.data)})},machineChange:function(){this.isDisabled=!0,this.isOpen?this.machineCtr("server_start"):this.machineCtrPop("server_stop")},machineCtrPop:function(t){var s=this,a=n.default.server[t];this.popperInfo("您确定要 "+a[4]+" 吗?",function(a){s.machineCtr(t)},function(t){s.isOpen=!s.isOpen,s.isDisabled=!1})},machineCtr:function(t){var s=this,a=n.default.server[t];this.waitingTip=a[3]+a[0]+"秒",this.$Global.async(t,!0).getData(null,this.machineid).then(function(t){if(0===t.status){s.isWaiting=!0,s.baseInfo.machine_status=a[1];var e=setTimeout(function(t){s.baseInfo.machine_status=a[2],s.isWaiting=!1,s.isDisabled=!1,clearTimeout(e)},1e3*a[0])}else s.$toast(t.message,"cc")})},deleteMachine:function(){var t=this;this.popperDelete(this.baseInfo.name,function(s){t.$Global.async("server_del",!0).getData({id:[t.$route.params.id]}).then(function(s){0===s.status&&t.$router.push({name:"Machines"}),t.$toast(s.message,"cc")})})}},computed:{businessStatus:function(){return n.default.business[this.baseInfo.business_status]||[]},machineStatus:function(){return n.default.machine[this.baseInfo.machine_status]||[]}},created:function(){this.getApiData()}}},161:function(t,s,a){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var e=a(156),i=function(t){return t&&t.__esModule?t:{default:t}}(e);s.default={mixins:[i.default]}}});
//# sourceMappingURL=0.e87f0f0e3e85ac80d661.js.map