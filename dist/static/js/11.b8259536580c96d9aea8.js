webpackJsonp([11],{230:function(t,e,a){var s=a(4)(a(399),a(489),null,null);t.exports=s.exports},245:function(t,e,a){t.exports=a.p+"static/img/spin.84f7c1b.gif"},247:function(t,e,a){t.exports={default:a(249),__esModule:!0}},249:function(t,e,a){var s=a(0),i=s.JSON||(s.JSON={stringify:JSON.stringify});t.exports=function(t){return i.stringify.apply(i,arguments)}},388:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a(247),i=function(t){return t&&t.__esModule?t:{default:t}}(s);e.default={data:function(){return{sokect:null,tcmname:"",formdata:{name:"",public_ip:"",username:"",passwd:"",cluster_id:0},status:"save",clusters:[]}},methods:{addHost:function(){var t=this;this.socket?this.sendHostData():this.initSocket(function(e){console.log(t.socket),t.sendHostData()})},sendHostData:function(){return""===this.formdata.name?void this.$toast("机器名称不能为空","cc"):""===this.formdata.public_ip?void this.$toast("ip不能为空","cc"):(this.socket.send((0,i.default)(this.formdata)),void(this.status="waiting"))},selectCluster:function(t){this.formdata.cluster_id=t},initClusters:function(){var t=this;this.rid=this.formdata.cluster_id=this.$route.params.id,0===parseInt(this.rid)?this.$Global.async("clusters").getData().then(function(e){t.clusters=e.data,t.formdata.cluster_id=t.clusters[0].id}):this.initSocket()},initSocket:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.socket=new WebSocket(this.$Global.apis.wsURL+this.$Global.apis.server_add.u),this.socket.onopen=function(t){e&&e()},this.socket.onmessage=function(e){"success"===e.data?t.$router.push({name:"Machines"}):"open"!==e.data&&(t.status="save",t.$toast(e.data,"cc"))},this.socket.onclose=function(e){t.timeoutajax&&clearTimeout(t.timeoutajax),t.socket=null,console.log("socket has closed")},this.timeoutajax&&clearTimeout(this.timeoutajax),this.timeoutajax=setTimeout(function(e){t.status="error",t.$toast("异常，请联系客服","cc"),t.socket.close(),clearTimeout(t.timeoutajax)},6e5)}},created:function(){this.initClusters()},beforeDestroy:function(){this.socket&&this.socket.close()}}},399:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a(388),i=function(t){return t&&t.__esModule?t:{default:t}}(s);e.default={mixins:[i.default]}},489:function(t,e,a){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"machine-add page-pad"},[s("panel",{attrs:{title:"添加主机"}},[s("table",{staticClass:"add-table"},[s("col",{attrs:{width:"20%"}}),t._v(" "),s("col",{attrs:{width:"80%"}}),t._v(" "),s("tbody",[s("tr",[s("td",{staticClass:"text-center"},[t._v("主机名称")]),t._v(" "),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.formdata.name,expression:"formdata.name"}],attrs:{type:"text"},domProps:{value:t.formdata.name},on:{input:function(e){e.target.composing||(t.formdata.name=e.target.value)}}})])]),t._v(" "),s("tr",[s("td",{staticClass:"text-center"},[t._v("IP")]),t._v(" "),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.formdata.public_ip,expression:"formdata.public_ip"}],attrs:{type:"text"},domProps:{value:t.formdata.public_ip},on:{input:function(e){e.target.composing||(t.formdata.public_ip=e.target.value)}}})])]),t._v(" "),s("tr",[s("td",{staticClass:"text-center"},[t._v("用户名")]),t._v(" "),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.formdata.username,expression:"formdata.username"}],attrs:{type:"text"},domProps:{value:t.formdata.username},on:{input:function(e){e.target.composing||(t.formdata.username=e.target.value)}}})])]),t._v(" "),s("tr",[s("td",{staticClass:"text-center"},[t._v("密码")]),t._v(" "),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.formdata.passwd,expression:"formdata.passwd"}],attrs:{type:"text"},domProps:{value:t.formdata.passwd},on:{input:function(e){e.target.composing||(t.formdata.passwd=e.target.value)}}})])])])]),t._v(" "),"waiting"===t.status?s("div",{staticClass:"p-16"},[s("img",{staticClass:"vam",attrs:{src:a(245),alt:""}}),t._v(" "),s("span",{staticClass:"vam"},[t._v("等待连接 大约需要1分钟")])]):t._e(),t._v(" "),"error"===t.status?s("div",{staticClass:"p-16"},[s("div",{staticClass:"hongse-text"},[t._v("异常，请联系客服")])]):t._e(),t._v(" "),"save"===t.status?s("div",{staticClass:"p-16 text-center"},[s("m-btn",{staticClass:"primary_bg no-radius grey-dark_txt",nativeOn:{click:function(e){t.addHost(e)}}},[t._v("确定添加")])],1):t._e()])],1)},staticRenderFns:[]}}});
//# sourceMappingURL=11.b8259536580c96d9aea8.js.map